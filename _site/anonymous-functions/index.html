<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>javascript - pass "this" to your anonymous functions</title>
   <meta name="author" content="Backbone Tutorials" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/reset.css" type="text/css" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
   
   <!-- github ribbon CSS -->
   <link rel="stylesheet" href="/css/ribbon.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
   
   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/stacklayout.css" type="text/css" media="screen, projection" />

   <!-- Typekit -->
   <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
 
    <style>
        .container {
            width: 760px;
            margin: auto;
        }
        .menu {
            margin-left: 40px;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        .menu a {
            margin-right: 10px;
        }
        p {
            width: 720px;
            margin: auto;
        }
    </style>
</head>
<body>
   <div class="left ribbon-holder">
        <a href="#" class="red ribbon">
          <span class="text">Fork me on GitHub</span>
        </a>
      </div>
<div class="container">
            <div class="menu">
            <a href="/">home</a>
            <a href="/">about</a>
            <a href="/">contribute</a>
            <a href="/">contact</a>
          </div>
          
                    
         
          
    <div class="stack">
        <div class="stackContent">
            <h1>Backbone Tutorials</h1>
            <p class="homepagedescription">This site is by no means the definite guide to backbone.js and all corrections and contributions are welcome.</p>
            <hr>
             <div id="post">
<h2>javascript &#8211; pass &#8220;this&#8221; to your anonymous functions</h2>
<p>Update: The initial solution was wrong and I tricked my self into thinking it was working through something I was working on at the time.  Sean and Joel have clarified in the comments<br />
as to why it was wrong.   I took down the hackernews post as it was getting far too much traffic for a wrong solution. Thanks guys!</p>
<p>There is now a working solution<br />
(unchecked by a professional lol) and would undelete the hackernews post so others could see the useful comments but I am unable to.</p>
<p>Anonymous functions in javascript are extremely powerful and if you don&#8217;t understand them fully just yet I would highly recommend learning asap.   A great guide can be found<br />
<a href="http://helephant.com/2008/08/javascript-anonymous-functions/" target="_blank">here</a>.   The problem with anonymous functions is that when declared the value of &#8220;this&#8221; changes<br />
depending on the situation and generally points to the functions scope.   <br /><br />This is generally not a desired effect and can cause people to use globals and other funky methods of accessing<br />
parent objects in anonymous functions. Below I will show you a simple way to access the parent object.   Always remember objects in Javascript are passed by reference!</p>
<h3>Passing &#8220;this&#8221; to the anonymous function</h3>
<p>This step is quite easy and I have used a famous alien robot for the example.   The robot wants to access his main weapon system from one of methods.  So the expected<br />
output is for the robot to fire &#8220;this.weapon&#8221; but as you see in the first example he cannot access his properties which are returned as &#8220;undefined&#8221;.</p>
<h2><a href="http://thomasdavis.github.com/examples/anonymous-functions/">Demo</a><br />
    <a href="https://github.com/thomasdavis/thomasdavis.github.com/tree/master/examples/anonymous-functions">Source</a></h2>
<div class="highlight"><pre><code class="javascript"><span class="c1">// Below is a simple function to find our autobots, </span>
<span class="c1">// just used for testing purposes</span>
<span class="kd">function</span> <span class="nx">findAutobot</span><span class="p">(){</span>
    <span class="c1">// Locate the autobots!</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// noob_bot is an example of what happens when you </span>
<span class="c1">// don&#39;t pass this to your anonymous functions</span>
<span class="nx">noob_bot</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">weapon</span><span class="o">:</span> <span class="s2">&quot;laser&quot;</span><span class="p">,</span>
    <span class="nx">kill</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="c1">// In the then statement we have declared an </span>
        <span class="c1">// anonymous function and we want to access noob_bots properties</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="nx">findAutobot</span> <span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Noob_bot: Fire the &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">weapon</span> <span class="o">+</span> <span class="s2">&quot;!!!#!&quot;</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Noob_bots weapon would have failed(undefined) because when</span>
<span class="c1">// you create anonymous functions the scope of &quot;this&quot;</span>
<span class="c1">// changes to the function.   So we use $.proxy(function, this) </span>
<span class="nx">megatron</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">weapon</span><span class="o">:</span> <span class="s2">&quot;laser&quot;</span><span class="p">,</span>
    <span class="nx">kill</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="c1">// Megatron has direct access to his weapon systems</span>
        <span class="c1">//  because we have called .bind(this)</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span> <span class="nx">findAutobot</span> <span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Megatron: Fire the &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">weapon</span> <span class="o">+</span> <span class="s2">&quot;!!!#!&quot;</span><span class="p">);</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>
    
<span class="nx">noob_bot</span><span class="p">.</span><span class="nx">kill</span><span class="p">();</span>
<span class="nx">megatron</span><span class="p">.</span><span class="nx">kill</span><span class="p">();</span>
</code></pre>
</div><h2><a href="http://thomasdavis.github.com/examples/anonymous-functions/">Demo</a><br />
    <a href="https://github.com/thomasdavis/thomasdavis.github.com/tree/master/examples/anonymous-functions">Source</a></h2>
<h3>Conclusion</h3>
<p>There are many other ways of passing &#8220;this&#8221; to an anonymous function and if you have any better suggestions I welcome you to post them.   Hopefully this tutorial has been helpful to you!  <br />
Fork me on github, using the link in the top left.</p>
<h3>Other implementations</h3>
<p>Just posting a few solutions posted by others below.</p>
<p>From sisk on hackernews<br />
<a href="http://news.ycombinator.com/item?id=2296064">http://news.ycombinator.com/item?id=2296064</a></p>
<div class="highlight"><pre><code class="javascript"><span class="nx">setTimeout</span><span class="p">(</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">){</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="nx">scope</span><span class="p">.</span><span class="nx">fire</span><span class="p">();};</span>
<span class="p">})(</span><span class="k">this</span><span class="p">),</span> <span class="mi">500</span>
<span class="p">);</span>
</code></pre>
</div><p>sisk : The short explanation is you return a function from an immediately-<br />
executing anonymous function that takes the current scope as a parameter.</p>
<p><span class="st_twitter_vcount" displayText="Tweet"></span><span class="st_facebook_vcount" displayText="Share"></span><span class="st_email_vcount" displayText="Email"></span><span class="st_sharethis_vcount" displayText="Share"></span><br />
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher:'bdee6d8c-ed9a-4867-90f6-011704c29ee3'});</script>	</article><br />
<script type="text/javascript">
SyntaxHighlighter.all()
</script>
<script>
var idcomments_acct = 'e6c0e0096f8106ea52c674a85b26ecf9';
var idcomments_post_id = "lasergun";
var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span><br />
<script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script></p>
</div>
</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>04 Mar 2011</span> &raquo; <a href="/jquery-create-your-own-deferred">Jquery Create Your Own Deferred</a></li>
    
      <li><span>07 Feb 2011</span> &raquo; <a href="/making-a-restful-ajax-app">Making A Restful Ajax App</a></li>
    
      <li><span>05 Feb 2011</span> &raquo; <a href="/backbone-views-and-templates">Backbone Views And Templates</a></li>
    
  </ul>
</div>
            


        </div>
      
    </div>
</div>
    
</body>
</html>
